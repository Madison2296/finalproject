# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate_mcmc_logs/pyrate_laura_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-177-final-project/pyrate_mcmc_logs/pyrate_laura_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.187841491008, 0.187841491008,0.156396322932,0.157405224534,0.158881681018,0.158881681018,0.135954377445,0.133444253591,0.133076749427,0.133444253591,0.133444253591,0.133076749427,0.133076749427,0.14050521266,0.14050521266,0.14866846046,0.157405224534,0.157911001541,0.157405224534,0.1599822739,0.16298049302,0.175134768204,0.174634627115,0.175134768204,0.17417922708,0.170262667041,0.13468863903,0.135182706987,0.135182706987,0.152891308675,0.152891308675,0.167526589719,0.167526589719,0.166317601549,0.166317601549,0.166317601549,0.165936465461,0.167526589719,0.167526589719,0.165936465461,0.165936465461,0.165936465461,0.165936465461,0.165326135099,0.165326135099,0.165326135099,0.165326135099,0.165326135099,0.165326135099,0.165072395808,0.165936465461,0.167526589719,0.167526589719,0.165936465461,0.164888943198,0.163393829909,0.154734305868,0.164888943198,0.165326135099,0.164888943198,0.164888943198,0.164888943198,0.164888943198,0.164888943198,0.164888943198,0.164888943198,0.166317601549,0.164888943198,0.164318902732,0.164318902732,0.164318902732,0.164318902732,0.164318902732,0.159205706818,0.164318902732,0.164318902732,0.164318902732,0.164318902732,0.164318902732,0.164318902732)
L_hpd_M95=c(0.452432510483, 0.452432510483,0.250596358799,0.249579466681,0.249579466681,0.248739586552,0.230708789921,0.193206775205,0.192693878284,0.192693878284,0.192693878284,0.192693878284,0.192693878284,0.196261510368,0.195660800241,0.200291793382,0.200666439619,0.197423749181,0.197423749181,0.206646170165,0.277327369462,0.279854139483,0.279369004241,0.279854139483,0.279369004241,0.279369004241,0.21107964863,0.20289760949,0.201439931324,0.206646170165,0.20289760949,0.202823937991,0.202823937991,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.20289760949,0.20289760949,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.201504496677,0.202367595699,0.204060738615,0.204060738615,0.20289760949,0.202823937991,0.204060738615,0.254793132094,0.312625336743,0.317284323625,0.317284323625,0.317752362886,0.319128409615,0.325030741849,0.32565749112,0.327659718111,0.327659718111,0.336929348729,0.32565749112,0.326881836474,0.317752362886,0.317752362886,0.3220712253,0.344607874804,0.355768526184,0.3737200198,0.3737200198,0.3737200198,0.3737200198,0.3737200198,0.3737200198)
M_hpd_m95=c(0.966844341546, 0.966844341546,0.122893463539,0.122893463539,0.122893463539,0.122893463539,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.123040601385,0.128114506931,0.135101138463,0.139900139872,0.142437201495,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.145785721462,0.0993403318497,0.0855302241078,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732,0.0840950696732)
M_hpd_M95=c(1.21759649575, 1.21759649575,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.149248241126,0.172056932319,0.179074738913,0.177580092507,0.175795731049,0.177580092507,0.177580092507,0.177580092507,0.177580092507,0.177580092507,0.177580092507,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.177505352598,0.175795731049,0.172056932319,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889,0.128271062889)
R_hpd_m95=c(-0.934421169666, -0.934421169666,0.0153229806749,0.0157856075779,0.0157856075779,0.0179118164228,0.000196439573565,-0.0110118596665,-0.0111778417766,-0.00552393155052,-0.00552393155052,-0.00552393155052,-0.00552393155052,0.000419005981581,0.00868195484401,0.00868195484401,0.0153229806749,0.0196829708574,0.0196829708574,0.0199617663941,0.0256408065818,0.0264292545358,0.0204700803307,0.0132882838193,0.00922238680537,0.00278191948608,-0.0195197522428,-0.0195197522428,-0.0195197522428,-0.0195197522428,-0.0141953250867,0.00176627716038,0.00198215788584,0.00198215788584,0.00198215788584,0.00204027533587,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00198215788584,0.00176627716038,0.00176627716038,0.00198215788584,0.0217431060987,0.0541905599481,0.0541905599481,0.0493326435568,0.0410615878228,0.0520875033906,0.0509627359803,0.0500152373058,0.0464766468626,0.0509627359803,0.0410615878228,0.0410615878228,0.0541905599481,0.0541905599481,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0368984413804,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228,0.0410615878228)
R_hpd_M95=c(-0.584406990103, -0.584406990103,0.110341517803,0.110057435619,0.106870901546,0.106870901546,0.091756363198,0.0549256778346,0.0544591917225,0.0586961924893,0.0586961924893,0.0576635489654,0.0576635489654,0.0558437258735,0.0622355464919,0.0586961924893,0.0597244127667,0.0614276797795,0.0625604035778,0.0707241875987,0.14198515736,0.14198515736,0.14198515736,0.122371161778,0.122371161778,0.122371161778,0.0569176285347,0.0461852831261,0.0439310480812,0.0409253329519,0.0455749270779,0.0440138409451,0.0440138409451,0.0439310480812,0.0439310480812,0.0439310480812,0.0440138409451,0.0439310480812,0.0439310480812,0.0440138409451,0.0440138409451,0.0440138409451,0.0439310480812,0.0440138409451,0.0440138409451,0.0440138409451,0.0440138409451,0.0440138409451,0.0440138409451,0.0440138409451,0.0440138409451,0.0897589664577,0.112484995773,0.106996738697,0.106996738697,0.108435528964,0.156478648673,0.213177502174,0.219094810453,0.221658825802,0.218525791604,0.225980264585,0.218525791604,0.221658825802,0.237216675607,0.23900509311,0.231572564757,0.229375748754,0.229375748754,0.217125334416,0.217125334416,0.221658825802,0.234536854164,0.247668247624,0.260328710068,0.260328710068,0.260328710068,0.260328710068,0.260328710068,0.260328710068)
L_mean=c(0.358987213335, 0.358987213335,0.184031851639,0.183684341947,0.183196857244,0.182236855688,0.175490245423,0.169148410515,0.169094931216,0.169051519265,0.169093272011,0.169233255657,0.169233255657,0.170485161247,0.170832836969,0.171999063337,0.173614243963,0.17445849808,0.174766114167,0.177779000057,0.204838003422,0.223434267143,0.22334409147,0.223420280332,0.223079570872,0.218819513002,0.178844297223,0.177236322676,0.17965276222,0.181058197064,0.18207288512,0.186588320904,0.186526126863,0.186613176607,0.186613176607,0.186572629672,0.186466430316,0.186418001187,0.186418001187,0.186401775115,0.186401775115,0.186397518821,0.186368595395,0.186352369324,0.186366898106,0.186366898106,0.186366898106,0.186366898106,0.186360381631,0.186255024706,0.186253674879,0.1863439868,0.1863439868,0.186400956683,0.186524532983,0.18733832384,0.192885088123,0.201510583672,0.204034403138,0.204653474011,0.205522694862,0.206151682799,0.207659262912,0.208806244645,0.209868125335,0.209978369392,0.212348944538,0.211760729581,0.21162051482,0.207370498277,0.2070574335,0.204827302133,0.211779478209,0.211032282383,0.211979183571,0.211979183571,0.211979183571,0.211979183571,0.211979183571,0.211979183571)
M_mean=c(1.07911299157, 1.07911299157,0.13725347705,0.136955412975,0.136955412975,0.136823823784,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136610572298,0.136648540243,0.136567715464,0.143269682163,0.15829532899,0.160873752056,0.161804772441,0.162046070865,0.162046070865,0.162046070865,0.162046070865,0.162046070865,0.162046070865,0.162078338532,0.162078338532,0.162078338532,0.162078338532,0.162078338532,0.162078338532,0.162078338532,0.162078338532,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.162076507144,0.156008330143,0.117470265194,0.107217077004,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532,0.107129401532)
R_mean=c(-0.720125778233, -0.720125778233,0.046778374589,0.046728928972,0.0462414442684,0.0454130319035,0.0388796731259,0.0325378382172,0.0324843589186,0.0324409469673,0.0324826997135,0.0326226833597,0.0326226833597,0.0338745889499,0.0342222646711,0.0353884910393,0.0370036716655,0.0378479257829,0.0381555418699,0.0411684277596,0.0681894631792,0.086866551679,0.0800744093069,0.0651249513418,0.0622058188162,0.0570147405602,0.016798226358,0.0151902518109,0.0176066913553,0.0190121261988,0.0200268142552,0.0245422500396,0.0244477883314,0.0245348380749,0.0245348380749,0.0244942911403,0.0243880917838,0.0243396626545,0.0243396626545,0.0243234365834,0.0243252679719,0.0243210116776,0.0242920882515,0.0242758621805,0.0242903909626,0.0242903909626,0.0242903909626,0.0242903909626,0.0242838744872,0.0241785175623,0.0241771677359,0.0303356566577,0.0688737216067,0.0791838796789,0.0793951314507,0.0802089223079,0.0857556865903,0.0943811821397,0.0969050016055,0.0975240724788,0.0983932933299,0.0990222812665,0.10052986138,0.101676843112,0.102738723802,0.102848967859,0.105219543006,0.104631328049,0.104491113288,0.100241096744,0.099928031968,0.0976979006011,0.104650076677,0.103902880851,0.104849782039,0.104849782039,0.104849782039,0.104849782039,0.104849782039,0.104849782039)
trans=0.5
age=(0:(80-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.497675761531), xlim = c(-84.0,4.0), ylab = 'Speciation rate', xlab = 'Ma',main='pyrate' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.33935614532), xlim = c(-84.0,4.0), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.02786328663, 0.286361581075), xlim = c(-84.0,4.0), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-84.0,4.0), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()